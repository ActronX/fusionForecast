[station]
# Geographic location and PV system orientation
latitude = 52.5200    # Decimal latitude (Example: Berlin)
longitude = 13.4050   # Decimal longitude
tilt = 30             # Panel tilt in degrees (0=flat)
# Azimuth: 0=South, -90=East, 90=West, 180=North
azimuth = 0           # Orientation angle

[influxdb]
# InfluxDB connection details
url = "http://localhost:8086" # Server URL
token = "YOUR_INFLUXDB_TOKEN_HERE" # API access token
org = "your_org"              # Organization name

[influxdb.buckets]
# Centralized data mapping (Buckets)
history_produced = "energy_data"   # Past PV generation data
regressor_history = "weather_data" # Historical weather data
regressor_future = "weather_data"  # Weather forecast data
target_forecast = "forecast_results" # Prediction output destination
live = "energy_meter"              # Real-time production for nowcasting

[influxdb.measurements]
# Measurement names for different data categories
produced          = "energy_meter"        # Source for actual PV production | ref: buckets.history_produced
regressor_history = "weather"             # Source for historic weather | ref: buckets.regressor_history
regressor_future  = "weather"             # Source for weather forecasts | ref: buckets.regressor_future
forecast          = "production_forecast" # Output for model predictions | ref: buckets.target_forecast
live              = "energy_meter"        # Real-time data source | ref: buckets.live
nowcast           = "nowcast"             # Output for nowcast adjustments | ref: buckets.target_forecast

[influxdb.fields]
# Data field mapping within measurements
# Format: field_name = "db_field" # Description | refs: buckets.<key> & measurements.<key>

produced = "power_produced"          # Actual PV power/energy produced | refs: buckets.history_produced & measurements.produced
forecast = "power_produced_forecast" # Final power production forecast | refs: buckets.target_forecast & measurements.forecast
live     = "production"              # Real-time power for nowcasting | refs: buckets.live & measurements.live

# Weather/Regressor fields (Source: buckets.regressor_history/future | measurements.regressor_history/future)
regressor_history    = "irradiance"           # Historic total irradiance (training) | refs: buckets.regressor_history & measurements.regressor_history
regressor_future     = "irradiance"           # Forecast total irradiance (prediction) | refs: buckets.regressor_future & measurements.regressor_future
diffuse              = "diffuse_radiation"    # (Required for pvlib) Diffuse radiation component | refs: buckets.regressor_history/future & measurements.regressor_history/future
direct               = "direct_normal_irradiance" # (Required for pvlib) Direct radiation component | refs: buckets.regressor_history/future & measurements.regressor_history/future
poa_perez            = "global_tilted_perez"  # (Required for pvlib) Calculated Perez POA irradiance | refs: buckets.regressor_history/future & measurements.regressor_history/future
effective_irradiance = "effective_irradiance" # (Required for pvlib) Irradiance after reflection losses (IAM) | refs: buckets.regressor_history/future & measurements.regressor_history/future

# Environmental sensors (Source: buckets.regressor_history/future | measurements.regressor_history/future)
temp_amb   = "temperature_2m"   # (Required for pvlib) Ambient air temperature | refs: buckets.regressor_history/future & measurements.regressor_history/future
wind_speed = "wind_speed_10m"   # (Required for pvlib) Wind speed at 10m height | refs: buckets.regressor_history/future & measurements.regressor_history/future
temp_cell  = "temperature_cell" # (Required for pvlib) Calculated solar cell temperature (SAPM) | refs: buckets.regressor_history/future & measurements.regressor_history/future

[weather.open_meteo.historic]
# Historic Data Fetch Settings
url = "https://historical-forecast-api.open-meteo.com/v1/forecast" # History API endpoint
start_date = "2024-01-01" # Start date for training history (YYYY-MM-DD)
end_date = "today"        # End date for training history
models = "best_match"      # Weather model selection
minutely_15 = "global_tilted_irradiance_instant" # 15min resolution variable

[weather.open_meteo.forecast]
# Future Forecast Fetch Settings
url = "https://api.open-meteo.com/v1/forecast" # Forecast API endpoint
forecast_days = 14                             # Number of days to predict
models = "best_match"                          # Model selection
minutely_15 = "global_tilted_irradiance_instant" # 15min resolution variable

[model]
# Central model parameters and storage
path = "models/prophet_model.pkl" # File path to save/load trained model
training_days = 731               # Days of data to use for training
forecast_days = 14                # Prediction horizon in days

[model.preprocessing]
# Data cleaning, scaling and alignment
max_power_clip = 6000 # Max system output in Watts (physical limit)
produced_scale = 1.0  # Multiplier for production data
regressor_scale = 1.0 # Multiplier for weather data
produced_offset = "-30m" # Align production timestamps
regressor_offset = "0m"  # Align weather timestamps
forecast_offset = "0m"   # Shift output timestamps

[model.prophet]
# Prophet specific forecasting settings
use_pvlib = false                # Enable physical solar models (Perez/IAM)
yearly_seasonality = false        # Enable annual cycles
seasonality_mode = "additive"    # Saisonal effect type
regressor_mode = "additive"      # Weather effect type
changepoint_prior_scale = 0.001 # Trend flexibility
seasonality_prior_scale = 1.0   # Seasonality influence strength
regressor_prior_scale = 5.0     # Weather data influence strength

[model.pvlib]
# Parameters for Effective Irradiance and SAPM Cell Temperature models
iam_b = 0.05       # Incidence angle modifier coefficient
sapm_a = -2.98     # Cell temperature model coefficient A
sapm_b = -0.0471   # Cell temperature model coefficient B
sapm_deltaT = 1    # Cell temperature model temperature delta

[model.tuning]
# Hyperparameter optimization settings for tune.py
process_count = 6      # Number of parallel CPU cores
night_threshold = 50   # Ignore values <= this during evaluation (Watts)
# Grid search ranges
changepoint_prior_scale = [0.001, 0.01, 0.1]  # Test range for trend
seasonality_prior_scale = [0.1, 1.0, 10.0]    # Test range for seasonality
regressor_prior_scale = [0.1, 0.5, 1.0, 3.0, 5.0] # Test range for weather
regressor_mode = ["additive", "multiplicative"]   # Test modes for regressors
seasonality_mode = ["additive", "multiplicative"] # Test modes for seasonality

[nowcast]
# Real-time adjustment (damping factor) settings
use_damping_factor = true  # Enable real-time correction based on actuals
min_damping_factor = 0.75  # Minimum allowed adjustment factor
max_damping_factor = 1.5   # Maximum allowed adjustment factor
